# MVC 패턴

MVC란 **M**odel **V**iew **C**ontroller의 약자로 애플리케이션을 세가지의 역활로 구분한 개발 방법론이다. 사용자가 Controller를 조작하면 Controller는 Model을 통해서 데이터를 가져오고 그 정보를 바탕으로 시각적인 표현을 담당하는 View를 제어해서 사용자에게 전달하게 된다.

## 1. Model

일반적으로 Model은 데이터에 관련되어진다.

### 1.1 wikipedia

모델은 사용자에게 어떻게 보일지에 대해 신경쓰지 않는다. 모델은 순수하게 public 함수로만 이루어진다. 몇몇 함수들은 사용자의 질의에 대해 상태 정보를 제공하고 나머지 함수들은 상태를 수정한다.

### 1.2 블로그(https://bsnippet.tistory.com/13)

데이터를 가진 객체를 모델이라 지칭. 데이터는 내부에 상태에 대한 정보를 가질수도 있고, 모델을 표현하는 이름 속성으로 가질 수 있다.

모델은 다음 규칙을 가지고 있음을 이해해야 한다.

1. 사용자가 편집하길 원하는 모든 데이터를 가지고 있어야만 한다.
2. 뷰나 컨트롤러에 대해서 어떤 정보도 알지 말아야한다.
   1. 데이터 변경이 일어 났을때, 모델에서 뷰를 직접 조정해서 수정할 수 있도록 뷰를 참조하는 내부 속성값을 가지면 안된다.
3. 변경이 일어나면, 변경 통지에 대한 처리 방법을 구현해야만 한다.
   1. 모델의 속성 중 텍스트 정보가 변경되면, 이벤트를  발생시켜 누군가에게 전달해야 하며, 누군가 모델을 변경하도록 요청하는 이벤트를 보냈을때 이를 수신할 수 있는 처리 방법을 구현해야 한다. 이는 모델이 변경되는 방법을 다른 구성 요소들에게 알려주게 되는 방법이다.

## 2. View

뷰는 클라이언트 측 기술인 html, css, javascript들을 모아둔 컨테이너이다.

### 2.1 wikipedia

MVC에서 모델은 여러 개의 뷰를 가질 수 있다. 뷰는 모델에게 질의를 하여 모델로 부터 값을 가져와 사용자에게 보여준다.

### 2.2 블로그(https://bsnippet.tistory.com/13)

화면에 표시되는 글자, 체크박스, 윈도우와 같은 UI라는 시각적 요소를 지칭.

규칙

1. 모델이 가지고 있는 정보를 따로 저장해서는 안된다.
   1. 화면에 글자를 표시 하기 위해, 모델 정보를 전달 받게 될텐데, 그 정보를 유지하기 위해서 임의로 뷰 내부에 저장하면 안된다. 단순히 네모 박스를 그리라는 명령을 받으면, 화면에 표시하기만 하고, 그 화면을 그릴때 필요한 정보들은 저장하지 않는다.
2. 모델이나 컨트롤러와 같이 다른 구성 요소를 몰라야 한다.
   1. 모델과 같이 자기 자신 뺴고는 다른 요소는 참조하거나 어떻게 동작하는지 알아서는 안된다. 뷰는 단순히 데이터를 받으면, 화면에 표시해주는 역활만 가진다고 보면된다.
3. 변경이 일어나면, 변경통지에 대한 처리 방법을 구현해야만 한다.
   1. 모델과 같이 변경이 일어났을때 이에 누군가에게 변경을 알려줘야하는 방법을 구현해야 한다. 뷰에서는 화면에서 사용자가 화면에 표시된 내용을 변경하게 되면 이를 모델에게 전달해서, 모델을 변경해야 할 것이다.

## 3. Controller

사용자가 접근 한 URL에 따라서 사용자의 요청사항을 파악한 후에 그 요청에 맞는 데이터를 Model에 request하고, 데이터를 View에 반영해서 사용자에게 알려준다.

### 3.1 wikipedia

MVC의 뷰는 여러 개의 컨트롤러를 가지고 있다. 사용자는 컨트롤러를 사용하여 모델의 상태를 바꾼다. 컨트롤러는 모델의 mutator(세터) 함수를 호출하여 상태를 바꾼다. 이때 모델의 상태가 바뀌면 모델은 등록된 뷰에 자신의 상태가 바뀌었다는 것을 알리고 뷰는 거기에 맞게 사용자에게 모델의 상태를 보여준다.

### 3.2 블로그(https://bsnippet.tistory.com/13)

모델과 뷰를 연결해주는 역활을 한다. 주로 비즈니스 로직(문제를 해결하기 위한 과정)이 이 컨트롤러에서 구현되어 있는 것이다. 음식 재료와 음식을 예로 들면, 음식재료가 있고 이를 조리법을 이용해 음식을 완성한다고 했을때, 음식 재료들은 데이터(model), 조리법은 컨트롤러, 완성된 음식은 뷰로 표현할 수 있다.

규칙

1. 모델이나 뷰에 대해서 알고 있어야 한다.
   1. 모델이나 뷰는 서로의 존재를 모르고, 변경을 외부로 알리고, 수신하는 방법만 가지고 있는데, 이를 컨트롤러가 중재하기 위해 모델과 그에 관련된 뷰에 대해서 알고 있어야 한다.
2. 모델이나 뷰의 변경을 모니터링 해야 한다.
   1. 모델이나 뷰의 변경을 통지 받으면, 이를 해석해서 각각의 구성요소에게 통지를 해야한다.

## 4. 원리 by wikipedia

자바언어에서 모델은 java.util.Observable을 상속받아 만들 수 있다. 모델에는 현재의 상태 정보를 변경하거나 다른 클래스에게 알릴 수 있는 함수가 있어야 한다. 모델의 상태를 변경하는 함수(mutator)는 setChanged()와 notifyObservers()를 호출하여야 한다. NotifyObser는 모델에 등록된 모든 뷰에게 업데이트 메시지를 보내게 된다. 뷰는 java.util.Observer를 implememt하여 만들면 updatemethod를 구현할 수 있다. update함수의 두 번째 매개변수는 Object 모델에서 넘어온 추가정보를 받는데 사용된다.

뷰는 반드시 모델에게 질의하여 업데이트하는 부분이 구현되야 한다. 모델은 addObserver라는 함수를 이용하여 뷰를 자신에게 등록시킨다. 모델은 자신에게 등록된 모든 뷰를 기억하고 있다가 자신의 상태가 바뀌게 되면 등록된 모든 뷰에 notify함수를 호출하여 뷰를 update시킨다. 모델은 뷰를 여러 개 가질 수 있다. MVC에서는 이것을 허용하고 있다. 또한 뷰도 여러개의 모델에 등록될 수 있다.

## 5. 단순 정리 by msm

쉽게 표현하면 url에 대응되어지고, url의 요청이 들어오면 model을 통하여 데이터를 가공하여 model을 view로 보내어 model에 맞도록 view가 출력되어진다.
스프링에서는 GetMapping("url")을 통하여 controller의 역활을 하고 이 함수에서 model을 가져오고 return값으로 view의 파일명을 return하여 view를 호출한다.

```java
// OwnerController.java in Spring-petclinic project
@GetMapping("/owners/find") // url매핑
public String initFindForm(Map<String, Object> model) {
    model.put("owner", new Owner()); // model에 데이터 put
    return "owners/findOwners"; // 출력될 화면의 파일명을 return
}
```
